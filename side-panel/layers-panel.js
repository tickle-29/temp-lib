"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.LayersPanel=void 0;const react_1=__importDefault(require("react")),mobx_react_lite_1=require("mobx-react-lite"),core_1=require("@blueprintjs/core"),l10n_1=require("../utils/l10n"),react_sortablejs_1=require("react-sortablejs"),text_1=require("../utils/text"),SortItem=(0,mobx_react_lite_1.observer)((({element:e,store:t})=>{const l=t.selectedElements.indexOf(e)>=0,[a,r]=react_1.default.useState(!1),n=()=>r(!1),i=a?e.name:e.name||(0,text_1.removeTags)(e.text)||`#${e.id}`;return react_1.default.createElement(core_1.Card,{onMouseDown:l=>{const a=l.ctrlKey||l.metaKey||l.shiftKey?[...t.selectedElementsIds]:[];a.indexOf(e.id)<0&&a.push(e.id),t.selectElements(a)},style:{padding:"5px",margin:"0px 1px 5px 1px",backgroundColor:l?"rgb(0, 161, 255, 0.2)":"",display:e.selectable?"auto":"none"}},react_1.default.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},react_1.default.createElement("div",{style:{lineHeight:"30px",display:"flex"}},react_1.default.createElement("div",{className:"drag-handle",style:{display:"flex",justifyContent:"center",alignItems:"center",cursor:"move",height:"30px"}},react_1.default.createElement(core_1.Icon,{icon:"drag-handle-vertical"})),react_1.default.createElement("div",{style:{padding:"0 7px",opacity:.5,width:"55px"}},e.type),react_1.default.createElement("div",{style:{maxWidth:"142px"}},react_1.default.createElement(core_1.EditableText,{minWidth:130,placeholder:(0,l10n_1.t)("sidePanel.namePlaceholder"),value:i,maxLines:1,onEdit:()=>r(!0),onCancel:n,onConfirm:n,onChange:t=>{e.set({name:t})}}))),react_1.default.createElement("div",null,react_1.default.createElement(core_1.Button,{minimal:!0,icon:(null==e?void 0:e.visible)?"eye-open":"eye-off",onClick:()=>{e.set({visible:!e.visible})}}),react_1.default.createElement(core_1.Button,{minimal:!0,icon:(null==e?void 0:e.locked)?"lock":"unlock",onClick:()=>{e.set({draggable:e.locked,contentEditable:e.locked,styleEditable:e.locked})}}),react_1.default.createElement(core_1.Button,{icon:"trash",minimal:!0,onClick:()=>{t.deleteElements([e.id])},style:{marginLeft:"auto"}}))))}));exports.LayersPanel=(0,mobx_react_lite_1.observer)((({store:e})=>{var t;const l=(null===(t=e.activePage)||void 0===t?void 0:t.children.map((e=>({id:e.id}))))||[];return l.reverse(),react_1.default.createElement("div",{style:{height:"100%",overflow:"auto"}},react_1.default.createElement("div",{style:{height:"40px",paddingTop:"5px"}},(0,l10n_1.t)("sidePanel.layersTip")),react_1.default.createElement("div",null,0===l.length?react_1.default.createElement("div",null,(0,l10n_1.t)("sidePanel.noLayers")):null,react_1.default.createElement(react_sortablejs_1.ReactSortable,{list:l,setList:t=>{t.forEach((({id:l},a)=>{var r,n;const i=t.length-a-1,c=e.getElementById(l);(null===(r=e.activePage)||void 0===r?void 0:r.children.indexOf(c))!==i&&(null===(n=e.activePage)||void 0===n||n.setElementZIndex(c.id,i))}))},direction:"horizontal"},l.map((({id:t})=>{const l=e.getElementById(t);return react_1.default.createElement(SortItem,{element:l,store:e,key:t})})))))}));