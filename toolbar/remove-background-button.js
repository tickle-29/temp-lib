"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.RemoveBackgroundButton=exports.RemoveBackgroundDialog=exports.setRemoveBackgroundFunc=void 0;const react_1=__importDefault(require("react")),mobx_react_lite_1=require("mobx-react-lite"),core_1=require("@blueprintjs/core"),api_1=require("../utils/api"),l10n_1=require("../utils/l10n");let removeBackgroundFunc=async e=>{const t=await fetch((0,api_1.removeBackground)(),{method:"POST",body:JSON.stringify({url:e})});if(200!==t.status)return alert((0,l10n_1.t)("error.removeBackground")),e;return(await t.json()).url};function setRemoveBackgroundFunc(e){removeBackgroundFunc=e}exports.setRemoveBackgroundFunc=setRemoveBackgroundFunc,exports.RemoveBackgroundDialog=(0,mobx_react_lite_1.observer)((({isOpen:e,onClose:t,element:r})=>{const[a,o]=react_1.default.useState(r.src);react_1.default.useEffect((()=>{o(r.src)}),[r.src]);const[c,n]=react_1.default.useState(!1),l=a!==r.src;return react_1.default.createElement(core_1.Dialog,{onClose:t,title:(0,l10n_1.t)("toolbar.removeBackgroundTitle"),isOpen:e,style:{width:"80%",maxWidth:"700px"}},react_1.default.createElement("div",{className:core_1.Classes.DIALOG_BODY},react_1.default.createElement("img",{src:a,style:{width:"100%",maxHeight:"400px",objectFit:"contain"}})),react_1.default.createElement("div",{className:core_1.Classes.DIALOG_FOOTER,style:{position:"relative"}},react_1.default.createElement("div",{style:{position:"absolute",top:"5px"}},"Powered by"," ",react_1.default.createElement("a",{href:"https://hotpot.ai/",target:"_blank"},"hotpot.ai")),react_1.default.createElement("div",{className:core_1.Classes.DIALOG_FOOTER_ACTIONS},!l&&react_1.default.createElement(core_1.Button,{onClick:async()=>{n(!0);try{o(await removeBackgroundFunc(r.src))}catch(e){console.error(e)}n(!1)},loading:c},(0,l10n_1.t)("toolbar.removeBackground")),l&&react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_1.Button,{onClick:()=>{o(r.src),t()},loading:c},(0,l10n_1.t)("toolbar.cancelRemoveBackground")),react_1.default.createElement(core_1.Button,{onClick:()=>{r.set({src:a}),t()},loading:c,intent:"primary"},(0,l10n_1.t)("toolbar.confirmRemoveBackground"))))))}));const RemoveBackgroundButton=({element:e})=>{const[t,r]=react_1.default.useState(!1);return react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_1.Button,{text:(0,l10n_1.t)("toolbar.removeBackground"),minimal:!0,onClick:e=>{r(!0)}}),react_1.default.createElement(exports.RemoveBackgroundDialog,{isOpen:t,onClose:()=>{r(!1)},element:e}))};exports.RemoveBackgroundButton=RemoveBackgroundButton;