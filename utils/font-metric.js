"use strict";Object.defineProperty(exports,"__esModule",{value:!0});let padding,context,canvas,initialized=!1;const settings={chars:{capHeight:"S",baseline:"n",xHeight:"x",descent:"p",ascent:"h",tittle:"i"}},initialize=()=>{canvas=document.createElement("canvas"),context=canvas.getContext("2d"),initialized=!0},setFont=(t,e,n)=>{initialized||(canvas=document.createElement("canvas"),context=canvas.getContext("2d"),initialized=!0),padding=.5*e,canvas.width=2*e,canvas.height=2*e+padding,context.font=`${n} ${e}px ${t}`,context.textBaseline="top",context.textAlign="center"},setAlignment=(t="top")=>{const e="bottom"===t?canvas.height:0;context.setTransform(1,0,0,1,0,e),context.textBaseline=t},updateText=t=>{context.clearRect(0,0,canvas.width,canvas.height),context.fillText(t,canvas.width/2,padding,canvas.width)},computeLineHeight=()=>{setAlignment("bottom");const t=canvas.height-measureBottom("A");return setAlignment("top"),measureBottom("A")+t},getPixels=t=>(updateText(t),context.getImageData(0,0,canvas.width,canvas.height).data),getFirstIndex=t=>{for(let e=3,n=t.length;e<n;e+=4)if(t[e]>0)return(e-3)/4;return t.length},getLastIndex=t=>{for(let e=t.length-1;e>=3;e-=4)if(t[e]>0)return e/4;return 0},normalize=(t,e,n)=>{const a={},i=t[n];for(let n in t)a[n]=(t[n]-i)/e;return a},measureTop=t=>Math.round(getFirstIndex(getPixels(t))/canvas.width)-padding,measureBottom=t=>Math.round(getLastIndex(getPixels(t))/canvas.width)-padding,getMetrics=(t=settings.chars)=>({capHeight:measureTop(t.capHeight),baseline:measureBottom(t.baseline),xHeight:measureTop(t.xHeight),descent:measureBottom(t.descent),bottom:computeLineHeight(),ascent:measureTop(t.ascent),tittle:measureTop(t.tittle),top:0}),FontMetrics=({fontFamily:t="Times",fontWeight:e="normal",fontSize:n=200,origin:a="baseline"}={})=>(setFont(t,n,e),Object.assign(Object.assign({},getMetrics()),{fontFamily:t,fontWeight:e,fontSize:n}));FontMetrics.settings=settings,exports.default=FontMetrics;